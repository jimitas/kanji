# 漢字テスト作成ツール - 印刷時2ページ目空白問題 調査ログ

## 概要
- **日付**: 2025-09-27
- **問題**: 印刷ボタンを押すと2ページ目に空白が表示される
- **環境**: Windows, 縦書きレイアウト（writing-mode: vertical-rl）

## 調査・試行記録

### 1. 初期状態の確認
- READMEファイルを作成してGitHubにpush
- 印刷時に2ページ目が空白で表示される問題を確認

### 2. 印刷設定の調整（試行1）
**アプローチ**: @page設定で余白調整
```css
@page {
  margin: 10mm;
  size: A4;
}
body {
  margin: 0;
  padding: 0;
}
.print_pages {
  height: auto !important;
  max-height: 90vh;
  page-break-after: avoid;
}
```
**結果**: ❌ 効果なし

### 3. 倍率変更テスト
**アプローチ**: 印刷時の倍率を50%に変更
```css
transform: scale(0.5);
```
**結果**: ❌ 50%でも2ページ目が出現

### 4. 初回コミットでの確認
- 初回コミット（2932ac8）の状態でも2ページ目が出現
- **結論**: 元々の設計上の問題と判明

### 5. 根本原因の調査

#### 調査した要因：
1. **bodyのwidth設定** (width: 100px)
2. **HTMLの固定高さ** (style="height: 748px;")
3. **CSSのサイズ設定** (height: 210mm, width: 297mm)
4. **縦書きレイアウト** (writing-mode: vertical-rl)

#### 判明した問題：
- 748px ≈ 280mm（A4の210mmを超過）
- 縦書きモードとA4横向きの組み合わせによる競合

### 6. HTMLの高さ指定削除
**アプローチ**: style="height: 748px;"を削除
**結果**: ❌ 1ページ目が余白、2ページ目が本文、3ページ目が余白

### 7. 縦書きモードのサイズ調整
**アプローチ**: 縦書きを考慮してheightとwidthを入れ替え
```css
.print_pages {
  height: 297mm;
  width: 210mm;
}
```
**結果**: ❌ 縦横が反対になり、はみ出し発生

### 8. 印刷時の縮小
**アプローチ**: 85%に縮小、各種page-break設定
```css
transform: scale(0.85);
height: 210mm !important;
page-break-after: avoid;
page-break-inside: avoid;
```
**結果**: ❌ 1ページ目が余白、2ページ目が本文、3ページ目が余白

### 9. 高さの調整
**アプローチ**: 748px → 560pxに変更
**結果**: ❌ レイアウトが崩れ、2ページ目は依然空白

### 10. 強制的な2ページ目非表示
**アプローチ**:
```css
@page:blank { display: none; }
.print_pages:nth-child(n+2) { display: none; }
```
**結果**: ❌ 1ページ目が空白になる問題発生

### 11. 印刷時の縮小（70%）
**アプローチ**: transform: scale(0.7)
**結果**: ❌ 効果なし

### 12. 改ページ制御の徹底
**アプローチ**: break-inside, break-after, page-break-*プロパティの総動員
```css
.print_pages {
  break-inside: avoid;
  page-break-inside: avoid;
  break-after: avoid;
  page-break-after: avoid;
}
```
**結果**: ❌ 効果なし

## 最終結論

### 問題の本質
- **縦書きレイアウト** (`writing-mode: vertical-rl`)
- **固定高さ** (748px ≈ 280mm)
- **A4横向き印刷** (210mm × 297mm)

これらの組み合わせにより、ブラウザの印刷エンジンが正しくページングできない構造的な問題。

### 解決策
CSSでの根本的解決は困難。以下の回避策を推奨：

1. **ブラウザの印刷設定で対応**
   - 拡大縮小を85-90%に設定
   - ページ指定で1ページ目のみ印刷

2. **READMEに既知の問題として記載**
   - 実装済み

### 試行した手法の総数
- **12種類以上**のアプローチを試行
- CSS改修、HTML修正、各種プロパティの組み合わせ

### 学んだこと
- 縦書きレイアウトと印刷の組み合わせは複雑
- transformによる縮小は印刷時の改ページ問題を解決しない
- ブラウザの印刷エンジンの制限がある

## 参考情報
- 初回コミット: 2932ac8
- 最終コミット: bc21138（READMEに既知の問題を追記）